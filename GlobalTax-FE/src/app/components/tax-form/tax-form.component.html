<div class="tax-container">
<div class="max-w-3xl mx-auto mt-6 p-6 bg-white rounded-lg shadow-md">
  <h2 class="text-2xl font-semibold mb-4">Tax Calculator</h2>

  <form (ngSubmit)="calculateTax()" class="space-y-4">

    <!-- Country Selector -->
    <div>
      <label class="block mb-1 font-medium">Country Code: </label>
      <select required class="border rounded p-2 w-full"  
      name="countryCode"
      [(ngModel)]="countryCode"
      (ngModelChange)="onCountryChange($event)">
        <option value="">Choose a country</option>
        <option *ngFor="let c of countries" [value]="c.countryCode">{{ c.countryName }}</option>
      </select>
    </div>

    <br/>
    <!-- Income Input -->
    <div>
      <label class="block mb-1 font-medium">Income: </label>
      <input
        type="text"
        [ngModel]="income | number:'1.0-0'"
        (ngModelChange)="onIncomeChange($event)"
        name="income"
        required
        class="border rounded p-2 w-full"
      />
      &nbsp; {{ currency }}
      <div *ngIf="incomeError" class="text-red-500 text-sm mt-1">
        Please enter a valid number
      </div>
    </div>

    <br/>

    <button type="submit" [disabled]="incomeError" class="bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600">
      Calculate
    </button>
  </form>

  <!-- Result Table -->
  <div *ngIf="taxResult" class="mt-12">
    <h3 class="text-lg font-semibold mb-2">Results</h3>
    <p><strong>Effective Rate:</strong> {{ taxResult.effectiveRate * 100 | number:'1.1-2' }}%</p>
    <p><strong>Total Tax:</strong> {{ taxResult.totalTax | currency: currency }}</p>
    <p><strong>Net income:</strong> {{ income - taxResult.totalTax | currency: currency }}</p>

    <div class="overflow-x-auto">
      <table class="w-full border-collapse border border-gray-300 text-left">
        <thead class="bg-gray-100">
          <tr>
            <th class="border p-2">Bracket Range</th>
            <th class="border p-2">Rate</th>
            <th class="border p-2">Taxed Amount</th>
            <th class="border p-2">Tax Owed</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let row of taxResult.breakdown">
            <td class="border p-2">{{ row.range }}</td>
            <td class="border p-2">{{ row.rate * 100 }}%</td>
            <td class="border p-2">{{ row.taxedAmount | currency: currency }}</td>
            <td class="border p-2">{{ row.taxOwed | currency: currency }}</td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
</div>
</div>